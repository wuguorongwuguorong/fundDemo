{{#extends "base"}}

{{#block "content"}}
<h2 class="mt-3">Edit Pnote</h2>

<form method="POST" action="/pnotes/{{pnote.pnote_id}}/edit" class="mb-4">
  <div class="row g-3">
    <!-- Customer -->
    <div class="col-md-6">
      <label class="form-label">Customer</label>
      <select name="cust_id" class="form-control" required>
        <option value="">-- Select Customer --</option>
        {{#each customers}}
          <option value="{{this.cust_id}}" {{#if (eq this.cust_id ../pnote.cust_id)}}selected{{/if}}>
            {{this.full_name}}
          </option>
        {{/each}}
      </select>
    </div>

    <!-- Agent -->
    <div class="col-md-6">
      <label class="form-label">Agent</label>
      <select name="agent_id" class="form-control" required>
        <option value="">-- Select Agent --</option>
        {{#each agents}}
          <option value="{{this.agent_id}}" {{#if (eq this.agent_id ../pnote.agent_id)}}selected{{/if}}>
            {{this.full_name}}
          </option>
        {{/each}}
      </select>
    </div>

    <!-- Dates -->
    <div class="col-md-4">
      <label class="form-label">Start Date</label>
      <!-- expects YYYY-MM-DD -->
      <input type="date" name="pstart_date" class="form-control"
             value="{{pnote.pstart_date_iso}}" required />
    </div>

    <div class="col-md-4">
      <label class="form-label">End Date (optional)</label>
      <input type="date" name="pend_date" class="form-control"
             value="{{pnote.pend_date_iso}}" />
    </div>

    <!-- Amounts -->
    <div class="col-md-4">
      <label class="form-label">Invested Amount</label>
      <input type="number" step="0.01" min="0" name="invest_amt" class="form-control"
             value="{{pnote.invest_amt}}" required />
    </div>

    <div class="col-md-4">
      <label class="form-label">Maintenance Fee</label>
      <input type="number" step="0.01" min="0" name="maintenance_fee" class="form-control"
             value="{{pnote.maintenance_fee}}" required />
    </div>
  </div>

  <button class="btn btn-primary mt-3" type="submit">Save</button>
  <a class="btn btn-secondary mt-3" href="/pnotes">Cancel</a>
</form>
{{/block}}

{{/extends}}
